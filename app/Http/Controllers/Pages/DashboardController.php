<?php namespace App\Http\Controllers\Pages;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use DaveJamesMiller\Breadcrumbs\Facade as Breadcrumbs;

use Carbon\Carbon;
use DB;

class DashboardController extends Controller {

    private $user;
    private $company;

    /**
    * Instantiate a new DashboardController instance.
    */
    public function __construct()
    {
        $this->user = auth()->user();
        if ($this->user)
            $this->company = $this->user->company;
    }

    public function getDashboard(Request $request)
    {
        $users = [];

        if($this->user->is('admin'))
            $users = DB::table('users')->orderBy('name', 'ASC')->paginate(25);
        else
            $users = DB::table('users')->where('company_id', '=', $this->company->id)->orderBy('name', 'ASC')->paginate(25);

        return view('pages.dashboard', compact('users'));
    }

}